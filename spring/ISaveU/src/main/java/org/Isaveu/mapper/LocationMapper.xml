<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper 
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper namespace="org.Isaveu.mapper.LocationMapper">
	<select id="locationByFireEx" parameterType="org.Isaveu.domain.LocationByFireExVO" resultType="org.Isaveu.domain.LocationByFireExVO" >
	SELECT
 		*
	FROM tb_location
	INNER JOIN
 	tb_fire_ex
		ON tb_location.location_id = tb_fire_ex.location_id;
	</select>
	
	<select id="moduleByLocation" parameterType="String" resultType="org.Isaveu.domain.ModuleByLocationVO">
	SELECT
		* 
	FROM tb_module
	INNER JOIN
	tb_location
		ON tb_module.location_id = tb_location.location_id
	WHERE
		module_id = #{value};
	</select>
	
	<select id="AndroidDisasterCheck" parameterType="String" resultType="org.Isaveu.domain.LocationByIssueVO">
	SELECT distinct
 	location.location, event.time, event.issue
	FROM tb_location location, tb_module module, tb_event event
	WHERE location.location_id = module.location_id and module.location_id = event.module_id
	and event.time > DATE_ADD(NOW(), INTERVAL -2 hour)
	limit #{value];
	
	</select>
	
	<select id="locationCount" parameterType="String" resultType="String">
	SELECT count(*)
	FROM tb_location
	WHERE location LIKE CONCAT(#{value},'%');
	</select>

</mapper>